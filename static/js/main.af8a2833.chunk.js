(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,n){e.exports=n(56)},27:function(e,t,n){},38:function(e,t,n){},40:function(e,t,n){},42:function(e,t,n){},44:function(e,t,n){},46:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(16),l=n.n(i),r=(n(27),n(7)),s=n(2),c=n(3),u=n(6),h=n(4),d=n(5),p=n(17),m=(n(38),n(40),n(42),n(1)),v=n(10),b=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={valueByKey:Object(m.a)({},n.props.ADSRProps)},n.handleChangeInput=function(e){return function(t){var a=n.props.updateADSRProps,o=parseFloat(t.target.value,10);isNaN(o)||a(e)(o)}},n.handleChangeKnob=function(e){return function(t){var a=n.props.updateADSRProps,o=n.state.valueByKey,i=Math.round(20*t)/20,l=o[e],s=("volMax"===e||"decayLevel"===e?1:5)/2;Math.abs(l-i)<=s&&(n.setState(function(t){return{valueByKey:Object(m.a)({},t.valueByKey,Object(r.a)({},e,i))}}),a(e)(i))}},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.ADSRProps,t=e.attack,n=e.decay,a=e.decayLevel,i=e.sustain,l=e.release,r=e.volMax;return o.a.createElement("div",{className:"ASDRPanel"},o.a.createElement("div",{className:"ASDRPanel__knobs"},o.a.createElement("div",{className:"ASDRPanel__control"},o.a.createElement("label",{className:"ASDRPanel__label"},"Volume"),o.a.createElement("div",{className:"ASDRPanel__input ASDRPanel__input--knob"},o.a.createElement(v.Knob,{value:r,max:1.1,min:0,onChange:this.handleChangeKnob("volMax"),preciseMode:!1,step:.1,unlockDistance:0})),o.a.createElement("input",{className:"ASDRPanel__input ASDRPanel__input--number",max:1.1,min:0,onChange:this.handleChangeInput("volMax"),step:.1,type:"number",value:r})),o.a.createElement("div",{className:"ASDRPanel__control"},o.a.createElement("label",{className:"ASDRPanel__label"},"Attack"),o.a.createElement("div",{className:"ASDRPanel__input ASDRPanel__input--knob"},o.a.createElement(v.Knob,{value:t,max:5.01,min:0,onChange:this.handleChangeKnob("attack"),preciseMode:!1,step:.05,unlockDistance:0})),o.a.createElement("input",{className:"ASDRPanel__input ASDRPanel__input--number",max:5.01,min:0,onChange:this.handleChangeInput("attack"),step:.05,type:"number",value:t})),o.a.createElement("div",{className:"ASDRPanel__control"},o.a.createElement("label",{className:"ASDRPanel__label"},"Decay"),o.a.createElement("div",{className:"ASDRPanel__input ASDRPanel__input--knob"},o.a.createElement(v.Knob,{value:n,max:5.01,min:0,onChange:this.handleChangeKnob("decay"),preciseMode:!1,step:.05,unlockDistance:0})),o.a.createElement("input",{className:"ASDRPanel__input ASDRPanel__input--number",max:5.01,min:0,onChange:this.handleChangeInput("decay"),step:.05,type:"number",value:n})),o.a.createElement("div",{className:"ASDRPanel__control"},o.a.createElement("label",{className:"ASDRPanel__label"},"Decay level"),o.a.createElement("div",{className:"ASDRPanel__input ASDRPanel__input--knob"},o.a.createElement(v.Knob,{value:a,max:1.01,min:0,onChange:this.handleChangeKnob("decayLevel"),preciseMode:!1,step:.05,unlockDistance:0})),o.a.createElement("input",{className:"ASDRPanel__input ASDRPanel__input--number",max:1.01,min:0,onChange:this.handleChangeInput("decayLevel"),step:.05,type:"number",value:a})),o.a.createElement("div",{className:"ASDRPanel__control"},o.a.createElement("label",{className:"ASDRPanel__label"},"Sustain"),o.a.createElement("div",{className:"ASDRPanel__input ASDRPanel__input--knob"},o.a.createElement(v.Knob,{value:i,max:5.01,min:0,onChange:this.handleChangeKnob("sustain"),preciseMode:!1,step:.05,unlockDistance:0})),o.a.createElement("input",{className:"ASDRPanel__input ASDRPanel__input--number",max:5.01,min:0,onChange:this.handleChangeInput("sustain"),step:.05,type:"number",value:i})),o.a.createElement("div",{className:"ASDRPanel__control"},o.a.createElement("label",{className:"ASDRPanel__label"},"Release"),o.a.createElement("div",{className:"ASDRPanel__input ASDRPanel__input--knob"},o.a.createElement(v.Knob,{value:l,max:5.01,min:0,onChange:this.handleChangeKnob("release"),preciseMode:!1,step:.05,unlockDistance:0})),o.a.createElement("input",{className:"ASDRPanel__input ASDRPanel__input--number",max:5.01,min:0,onChange:this.handleChangeInput("release"),step:.05,type:"number",value:l}))))}}]),t}(a.Component),g=(n(44),n(9)),f=n.n(g),_=(n(46),n(18)),y=n.n(_),D={C0:16.35,"C#0":17.32,Db0:17.32,D0:18.35,"D#0":19.45,Eb0:19.45,E0:20.6,F0:21.83,"F#0":23.12,Gb0:23.12,G0:24.5,"G#0":25.96,Ab0:25.96,A0:27.5,"A#0":29.14,Bb0:29.14,B0:30.87,C1:32.7,"C#1":34.65,Db1:34.65,D1:36.71,"D#1":38.89,Eb1:38.89,E1:41.2,F1:43.65,"F#1":46.25,Gb1:46.25,G1:49,"G#1":51.91,Ab1:51.91,A1:55,"A#1":58.27,Bb1:58.27,B1:61.74,C2:65.41,"C#2":69.3,Db2:69.3,D2:73.42,"D#2":77.78,Eb2:77.78,E2:82.41,F2:87.31,"F#2":92.5,Gb2:92.5,G2:98,"G#2":103.83,Ab2:103.83,A2:110,"A#2":116.54,Bb2:116.54,B2:123.47,C3:130.81,"C#3":138.59,Db3:138.59,D3:146.83,"D#3":155.56,Eb3:155.56,E3:164.81,F3:174.61,"F#3":185,Gb3:185,G3:196,"G#3":207.65,Ab3:207.65,A3:220,"A#3":233.08,Bb3:233.08,B3:246.94,C4:261.63,"C#4":277.18,Db4:277.18,D4:293.66,"D#4":311.13,Eb4:311.13,E4:329.63,F4:349.23,"F#4":369.99,Gb4:369.99,G4:392,"G#4":415.3,Ab4:415.3,A4:440,"A#4":466.16,Bb4:466.16,B4:493.88,C5:523.25,"C#5":554.37,Db5:554.37,D5:587.33,"D#5":622.25,Eb5:622.25,E5:659.26,F5:698.46,"F#5":739.99,Gb5:739.99,G5:783.99,"G#5":830.61,Ab5:830.61,A5:880,"A#5":932.33,Bb5:932.33,B5:987.77,C6:1046.5,"C#6":1108.73,Db6:1108.73,D6:1174.66,"D#6":1244.51,Eb6:1244.51,E6:1318.51,F6:1396.91,"F#6":1479.98,Gb6:1479.98,G6:1567.98,"G#6":1661.22,Ab6:1661.22,A6:1760,"A#6":1864.66,Bb6:1864.66,B6:1975.53,C7:2093,"C#7":2217.46,Db7:2217.46,D7:2349.32,"D#7":2489.02,Eb7:2489.02,E7:2637.02,F7:2793.83,"F#7":2959.96,Gb7:2959.96,G7:3135.96,"G#7":3322.44,Ab7:3322.44,A7:3520,"A#7":3729.31,Bb7:3729.31,B7:3951.07,C8:4186.01},A=n(20),E=n(8),S=n(19),T=n.n(S),w=n(13),x=n.n(w),C=function(e){return function(t){var n=t;t instanceof window.Event||(n=t.nativeEvent);var a=null;if(n.touches&&n.touches.length){var o=n.touches[0];a={x:o.clientX,y:o.clientY}}else n.clientX&&n.clientY&&(a={x:n.clientX,y:n.clientY});for(var i=arguments.length,l=new Array(i>1?i-1:0),r=1;r<i;r++)l[r-1]=arguments[r];return e.apply(void 0,[a,t].concat(l))}},k=function(){function e(t,n,a){Object(s.a)(this,e),this._listenersAdded=!1,this._currentAnimationFrame=null,this._onTouchStart=t,this._onTouchMove=n,this._onTouchEnd=a,this._handleTouchStart=C(this._handleTouchStart.bind(this)),this._handleMouseDown=C(this._handleMouseDown.bind(this)),this._handleTouchMove=C(this._handleTouchMove.bind(this)),this._handleTouchEnd=C(this._handleTouchEnd.bind(this))}return Object(c.a)(e,[{key:"listeners",value:function(e,t,n){var a=this;return{onTouchStart:function(n){return a._handleTouchStart(n,e,t)},onMouseDown:function(t){return a._handleMouseDown(t,e,n)}}}},{key:"removeListeners",value:function(){this._listenersAdded=!1,document.removeEventListener("touchmove",this._handleTouchMove),document.removeEventListener("touchend",this._handleTouchEnd),document.removeEventListener("touchcancel",this._handleTouchEnd),document.removeEventListener("mousemove",this._handleTouchMove),document.removeEventListener("mouseup",this._handleTouchEnd)}},{key:"cancelAnimationFrame",value:function(){x.a.cancel(this._currentAnimationFrame),this._currentAnimationFrame=null}},{key:"_addTouchListeners",value:function(){this._listenersAdded=!0,document.addEventListener("touchmove",this._handleTouchMove),document.addEventListener("touchend",this._handleTouchEnd),document.addEventListener("touchcancel",this._handleTouchEnd)}},{key:"_addMouseListeners",value:function(){this._listenersAdded=!0,document.addEventListener("mousemove",this._handleTouchMove),document.addEventListener("mouseup",this._handleTouchEnd)}},{key:"_handleTouchStart",value:function(e,t,n,a){this._listenersAdded||(this._addTouchListeners(),n.props.onTouchStart&&n.props.onTouchStart(t),a&&a(t),this._onTouchStart(e,t))}},{key:"_handleMouseDown",value:function(e,t,n,a){this._listenersAdded||(this._addMouseListeners(),n.props.onMouseDown&&n.props.onMouseDown(t),a&&a(t),this._onTouchStart(e,t))}},{key:"_handleTouchMove",value:function(e,t){var n=this;this._currentAnimationFrame||(this._currentAnimationFrame=x()(function(){n._currentAnimationFrame=null,n._onTouchMove(e,t)}))}},{key:"_handleTouchEnd",value:function(e,t){this.cancelAnimationFrame(),this.removeListeners(),this._onTouchEnd(e,t)}}]),e}(),O=n(21),M=[["left","dx",j],["top","dy",j],["bottom","dy",P],["right","dx",P],["translateX","dx",j],["translateY","dy",j]];function j(e,t){return e+t}function P(e,t){return j(e,-t)}var R=function(e,t){return M.reduce(function(n,a){var o=Object(O.a)(a,3),i=o[0],l=o[1],r=o[2];return void 0!==e[i]&&(n[i]=r(e[i],t[l])),n},{})},N=function(e,t){var n=e.x,a=e.y;return{dx:t.x-n,dy:t.y-a}},L={initial:null,current:null,deltas:{dx:0,dy:0}},F=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e))).state=L,n._touchHandler=new k(n.handleTouchStart.bind(Object(E.a)(Object(E.a)(n))),n.handleTouchMove.bind(Object(E.a)(Object(E.a)(n))),n.handleTouchEnd.bind(Object(E.a)(Object(E.a)(n)))),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"passThroughState",value:function(){var e=this.props.position,t=this.state,n=t.deltas,a=t.current,o=R(e,n);return Object(m.a)({},o,n,a)}},{key:"handleTouchStart",value:function(e){this.setState({initial:e,current:e})}},{key:"handleTouchMove",value:function(e,t){var n=this.state,a=n.deltas,o=n.current,i=N(o,e),l=R(this.props.position,i);this.props.onDrag&&this.props.onDrag(Object(m.a)({},l,o),t);var r={dx:a.dx+i.dx,dy:a.dy+i.dy};this.setState({deltas:r,current:e})}},{key:"handleTouchEnd",value:function(){this.props.onDragEnd&&this.props.onDragEnd()}},{key:"render",value:function(){var e=this.props,t=e.onTouchStart,n=e.onMouseDown,a=e.children,i=e.__passThrough,l=Object(m.a)({},i,this.passThroughState()),r=T()(a)?a(Object(m.a)({},l)):a,s=Object(m.a)({},this._touchHandler.listeners(r,t,n));return r.type.propTypes&&r.type.propTypes.hasOwnProperty("__passThrough")&&(s.__passThrough=l),o.a.cloneElement(o.a.Children.only(r),s)}}]),t}(o.a.Component),G=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i)))).state={dragging:!1,height:null,initialTouchX:null,initialTouchY:null,parentX:null,parentY:null,touchX:null,touchY:null,width:null},n.DraggableParent=o.a.createRef(),n.handleMouseDown=function(e){var t=n.props.onStrikeStart;if(n.DraggableParent.current){var a=n.DraggableParent.current,o=a.offsetWidth,i=a.offsetHeight,l=a.offsetLeft,r=a.offsetTop,s=(e.clientX-l)/o,c=(e.clientY-r)/i;n.setState({dragging:!0,height:i,initialTouchX:s,initialTouchY:c,parentX:l,parentY:r,touchX:s,touchY:c,width:o,lastEvent:"handleMouseDown"}),t&&t({touchY:c})}},n.handleTouchStart=function(e){var t=n.props.onStrikeStart;if(!e.touches||e.touches.length,n.DraggableParent.current){var a=n.DraggableParent.current,o=a.offsetWidth,i=a.offsetHeight,l=a.offsetLeft,r=a.offsetTop,s=Object(A.a)(e.touches).pop()||{},c=(s.clientX-l)/o,u=(s.clientY-r)/i;n.setState({dragging:!0,height:i,initialTouchX:c,initialTouchY:u,parentX:l,parentY:r,touchX:c,touchY:u,width:o,lastEvent:"handleTouchStart"}),t&&t({touchY:u})}},n.handleDrag=function(e,t){var a=n.state,o=a.dragging,i=a.height,l=a.parentX,r=a.parentY,s=a.width;if(o&&n.DraggableParent.current&&n.DraggableParent.current.contains(t.target)){var c=(e.x-l)/s,u=(e.y-r)/i;return c<0||c>1||u<0||u>1?(n.setState({dragging:!1}),void n.handleDragEnd()):void 0}},n.handleDragEnd=function(){var e=n.props.onStrikeEnd;n.setState({dragging:!1,lastEvent:"handleDragEnd"}),e&&e()},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.style;return o.a.createElement("div",{ref:this.DraggableParent,style:Object(m.a)({position:"relative"},e)},o.a.createElement(F,{onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart,onDrag:this.handleDrag,onDragEnd:this.handleDragEnd,position:{left:0,top:0}},function(t){return o.a.createElement("div",null,o.a.createElement("div",{style:Object(m.a)({},e,{position:"absolute",width:"100%",height:"100%",top:"0",left:"0"})}))}))}}]),t}(a.Component),B=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={started:!1,playing:!1,nextVolume:n.props.volMute,context:n.props.context||window.AudioContext&&new window.AudioContext||window.webkitAudioContext&&new window.webkitAudioContext||null},n.handleStrikeStart=function(e){var t=n.props,a=t.volMax,o=t.volMute,i=t.attack,l=t.decay,r=t.decayLevel,s=t.sustain;n.state.started||n.setState({started:!0},function(){return n.oscillator.start(0)});var c=n.state.context,u=n.gainNode.gain.value,h=a*(.6*e.touchY+.4),d=h*(r||.3);n.gainNode.gain.cancelScheduledValues(c.currentTime),n.gainNode.gain.setValueAtTime(u,c.currentTime),n.gainNode.gain.exponentialRampToValueAtTime(h,c.currentTime+i),n.gainNode.gain.exponentialRampToValueAtTime(d,c.currentTime+i+l),n.gainNode.gain.exponentialRampToValueAtTime(o,c.currentTime+i+l+s),n.setState({playing:!0})},n.handleStrikeEnd=function(){var e=n.props,t=e.volMute,a=e.release,o=n.state.context,i=n.gainNode.gain.value;n.gainNode.gain.cancelScheduledValues(o.currentTime),n.gainNode.gain.setValueAtTime(i,o.currentTime),n.gainNode.gain.exponentialRampToValueAtTime(t,o.currentTime+a),n.setState({playing:!1})},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.note,n=e.volMute,a=this.state.context;this.gainNode=a.createGain(),this.oscillator=a.createOscillator(),this.oscillator.type="sine",this.oscillator.frequency.value=D[t],this.gainNode.gain.setValueAtTime(n,a.currentTime),this.oscillator.connect(this.gainNode),this.gainNode.connect(a.destination),this.nextGain=null}},{key:"render",value:function(){var e,n=this.props,a=n.note,i=n.style,l=this.state.playing,s=a.indexOf("#")>=0||a.indexOf("b")>=0,c=y()(t.baseClass,(e={},Object(r.a)(e,"".concat(t.baseClass,"--active"),l),Object(r.a)(e,"".concat(t.baseClass,"--black"),s),e));return o.a.createElement("div",{className:c,style:Object(m.a)({},i,{display:"grid",gridTemplateRows:"1fr",gridTemplateColumns:"1fr"})},o.a.createElement(G,{onStrikeStart:this.handleStrikeStart,onStrike:function(){},onStrikeEnd:this.handleStrikeEnd,style:{display:"grid",gridTemplateRows:"1fr",gridTemplateColumns:"1fr",position:"absolute",width:"100%",height:"100%",top:"0",left:"0",color:s?"#444":"#ccc"}}))}}]),t}(a.Component);B.baseClass="Key",B.defaultProps={note:"C4",volMute:1e-4,volMax:1,attack:.03,decay:.1,decayLevel:.5,sustain:2,release:1};var K=B,Y=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={context:window.AudioContext&&new window.AudioContext||window.webkitAudioContext&&new window.webkitAudioContext||null},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.attack,n=e.decay,a=e.decayLevel,i=e.release,l=e.sustain,r=e.volMax,s=e.volMute,c=this.state.context,u={flex:"1 1 auto",minWidth:"0",overflow:"hidden"},h={volMax:r,volMute:s},d={attack:t,decay:n,decayLevel:a,sustain:l,release:i};return o.a.createElement("div",{className:"KeyBoard",style:{display:"flex",flexFlow:"row nowrap",alignItems:"stretch",justifyContent:"flex-start",height:"90vh",flex:"1 1 auto",minHeight:"0",userSelect:"none"}},["C4","C#4","D4","D#4","E4","F4","F#4","G4","G#4","A4","A#4","B4","C5","C#5"].map(function(e){return o.a.createElement(K,Object.assign({context:c,key:e,note:e},h,d,{style:Object(m.a)({},u)}))}))}}]),t}(a.Component);K.propTypes={volMute:f.a.number,volMax:f.a.number,attack:f.a.number,decay:f.a.number,decayLevel:f.a.number,sustain:f.a.number},K.defaultProps={volMute:1e-4,volMax:1,attack:.03,decay:.03,decayLevel:.5,sustain:2,release:1};var X=Y,V=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={attack:.05,decay:.05,decayLevel:.5,release:1,sustain:3,volMax:1},n.updateADSRProps=function(e){return function(t){return n.setState(Object(r.a)({},e,t))}},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.state,t=e.attack,n=e.decay,a=e.decayLevel,i=e.sustain,l=e.release,r=e.volMax,s={attack:t,decay:n,decayLevel:a,sustain:i,release:l,volMax:r};return o.a.createElement("div",{className:"App",style:{display:"flex",flexFlow:"column nowrap",height:"100vh",width:"100vw"}},o.a.createElement(p.Helmet,null,o.a.createElement("title",null,"Musico")),o.a.createElement("div",{style:{flex:"0 0 10vw",minHeight:"0",display:"grid",gridTemplateColumns:"1fr",gridTemplateRows:"1fr"}},o.a.createElement(b,{ADSRProps:s,update:this.update,updateADSRProps:this.updateADSRProps})),o.a.createElement("div",{style:{flex:"1 1 auto",minHeight:"0",overflow:"hidden",display:"flex",flexFlow:"column nowrap"}},o.a.createElement(X,Object.assign({volMute:1e-4,volMax:r},s))))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[22,2,1]]]);
//# sourceMappingURL=main.af8a2833.chunk.js.map